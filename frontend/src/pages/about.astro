---
import type { User } from '../api';
import type { ApiResponse } from '../api/api_response';
import Link from '../components/Link.astro';
import TextWithIcon from '../components/TextWithIcon.astro';
import { API_URL, IMAGE_URL } from '../constants';
import Layout from '../layouts/Layout.astro';
const response = await fetch(`${API_URL}/user/describe`);
const {
    data: { name, email, phone, direction, image, description }
}: ApiResponse<User> = await response.json();
---

<Layout title="ATRA - Qui som">
    <section>
        <picture>
            <img
                src={`${IMAGE_URL}/${image.Key}`}
                alt={image.name || image.Key}
            />
        </picture>
        <article class="about-container">
            <div class="about-title">
                <h1>ATRA</h1>
                <h3>Asistència tècnica en rehabilitació i arquitectura</h3>
            </div>
            <div class="about-content">
                <div class="description">
                    {description.split('. ').map((text) => <p>{text}.</p>)}
                </div>
                <div class="user-info">
                    <h3><span>Arquitecte</span> {name}</h3>
                    <h3><span>Correu</span> {email}</h3>
                    <h3><span>Telèfon</span> {phone}</h3>
                    <a
                        href="https://opr-short-url.vercel.app/f253f3fb"
                        target="_blank"
                    >
                        <span>Direcció</span>
                        <p>{direction}</p>
                    </a>
                </div>
            </div>
        </article>
    </section>
</Layout>

<style>
    section {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100vw;
        max-width: var(--max-width);
        margin-bottom: 3rem;
    }

    picture {
        margin-top: 2rem;
        width: 100%;
    }

    h1,
    h3 {
        font-weight: 300;
    }

    h1 {
        font-size: 2rem;
    }

    .about-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0 3rem;
    }

    p {
        font-size: 1rem;
        color: rgb(82, 82, 82);
        text-wrap: pretty;
    }

    .about-title {
        align-self: flex-start;

        h3 {
            margin-top: -1rem;
        }
    }

    .about-content {
        display: flex;
        align-items: center;
        gap: 2rem;
    }

    .description {
        width: 50%;
    }

    .user-info {
        display: flex;
        flex-direction: column;
        margin-left: 4rem;

        span {
            font-size: 1rem;
            font-weight: 500;
            text-transform: uppercase;
            margin-right: 1rem;
            color: black;
        }

        h3,
        p {
            font-size: 1rem;
            color: rgb(108, 108, 108);
        }

        a {
            display: flex;
            align-items: center;
            color: inherit;
            width: fit-content;
            padding-right: 1rem;
        }
    }

    @media (width < 850px) {
        .about-content {
            display: flex;
            flex-direction: column;
        }

        .description {
            width: 100%;
        }

        .about-container {
            margin-bottom: 0;
        }
    }

    @media (width < 430px) {
        .user-info span {
            display: block;
            margin-bottom: 0.5rem;
        }

        .user-info a {
            display: flex;
            flex-direction: column;
            align-items: start;
        }

        .user-info a span {
            margin-top: 1rem;
        }

        .user-info a p {
            margin-top: -0.1rem;
        }
    }
</style>
